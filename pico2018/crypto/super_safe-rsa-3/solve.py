#!/usr/bin/env python

import gmpy2

def main():
    c = 2242935168115062974499751873249754323110921862340005025797429496249617165457457004035424984007628148314470840283322628336277990956956934305264525083803938682928102121588782027436478869856006901933451768987204715587910773098107493173209888339290058783726917348808343191586406306568637517837353899357179182
    n = 2627153264428508244022299245870943256933139743330880416542975797741751309049801231342077641593189843757280969996185613768596522142633781213226541711288701850667973142372467264747367778283723640648970160596683631157326350160186691083243170812162200614410196661211520277251176842534601959297281680522753579
    e = 65537
    factors = [
        2175580103,
        2282408507,
        2295698099,
        2384501797,
        2407758713,
        2531787773,
        2548448501,
        2578840073,
        2583724721,
        2649339439,
        2778665663,
        2795137091,
        2871391183,
        2883925867,
        2934872777,
        2935540277,
        3167018887,
        3193377149,
        3202853603,
        3252684179,
        3309244537,
        3355822619,
        3375565619,
        3497193893,
        3537623773,
        3580533701,
        3698260381,
        3704371501,
        3717246517,
        4026976607,
        4194174541,
        4226633459,
    ]

    divisor = 1
    for x in factors:
        divisor = gmpy2.lcm(x - 1, divisor)

    totient = divisor
    print("totient: %r" % totient)

    d = gmpy2.invert(e, totient)

    print("d: %r" % d)
    m = pow(c, d, n)
    plain = '%x' % m
    plain = bytearray.fromhex(plain)
    print(plain)


if __name__ == '__main__':
    main()
