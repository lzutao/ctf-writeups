#include <x86intrin.h>

const char BIN[] = {
  0x7b, 0x18, 0xa6, 0x34, 0xd9, 0x3c, 0x2d, 0xa3, 0xff, 0xce, 0x86, 0xab, 0x92, 0xfb, 0x9a, 0x42,
  0x8b, 0x32, 0xa3, 0xaa, 0xfb, 0x96, 0x8a, 0x3b, 0x42, 0xa3, 0xfa, 0x86, 0x82, 0xbb, 0x26, 0xc3,
  0xba, 0x0e, 0x32, 0xca, 0xea, 0x63, 0x0c, 0x5b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

int main(int argc, char *argv[])
{
  size_t len = 0; //ebp-0xc

  for (char *passwd = argv[1]; *passwd; ++passwd) {//ebp-0x4
    len++;
  }

  // i @ ebp-0x8
  for (size_t i = 0; i < len - 3; ++i) {
    char *c = &(argv[1][i]); //ebp-0x4
    *c ^= 0xf8;
    *(short *)c = __rorw(*(short *)c, 0xd);
    *(int *)c = __rold(*(int *)c, 0xb);
  }

  char *argv1 = argv[1]; //ebp-4
  const char *ptr; //ebp-0x10
  for (ptr = BIN; *ptr; ++ptr, ++argv1) {
    if (*argv1 != *ptr) {
      return 0;
    }
  }

  if (*(argv[1] + (ptr - BIN)) == 0) {
    return 1;
  }

  return 0;
}
